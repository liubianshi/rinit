# Project-level .Rprofile
# This file is executed when R starts in this project directory

# First, source user-level .Rprofile if it exists (to preserve user settings)
if (file.exists("~/.Rprofile")) {
  source("~/.Rprofile")
}

# General R options
options(
  stringsAsFactors = FALSE,
  max.print = 100,
  scipen = 10,
  width = 120,
  box.path = c(file.path(getwd(), "r-box"), getwd())
)

# Activate renv if available
if (file.exists("renv/activate.R")) {
  source("renv/activate.R")
}

# ENVIRONMENT VARIABLE
METADATA <- yaml::read_yaml("_metadata.yml")
CONFIG <- yaml::read_yaml("config.yml")
PROJECT_NAME <- METADATA$project_name
Sys.setenv(PROJECT_NAME = PROJECT_NAME)
LOG <- local({
  box::use(R/utils/logger)
  logger$logger_factory(PROJECT_NAME)
})
box::use(R/utils/cache_result[...])

# Project startup message
packageStartupMessage(
  paste0("\n", "âœ… Project loaded: ", PROJECT_NAME, "\n", "ðŸ“‚ Working directory: ", getwd(), "\n")
)
